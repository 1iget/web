--- fips-1.0/rand/@fips_rand.c	2007-11-01 17:12:07.000000000 -0400
+++ fips-1.0/rand/fips_rand.c	2007-11-01 17:18:04.000000000 -0400
@@ -205,6 +205,7 @@
     n_seed=0;
     o_seed=0;
     key_init=0;
+    key_set=0;
     }
 
 void FIPS_rand_seed(const void *buf_, FIPS_RAND_SIZE_T num)
--- fips-1.0/rand/@fips_rand_selftest.c	2007-11-01 17:16:41.000000000 -0400
+++ fips-1.0/rand/fips_rand_selftest.c	2007-11-01 17:17:07.000000000 -0400
@@ -114,6 +114,7 @@
 	    }
 	}
     FIPS_test_mode(0,NULL);
+    FIPS_rand_method()->cleanup();
     return 1;
     }
 
